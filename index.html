<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8" />
<!--允许全屏-->
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="yes" name="apple-touch-fullscreen"/>
<meta content="telephone=no,email=no" name="format-detection"/>
<link rel="apple-touch-icon" href="favicon.png"/>
<link rel="Shortcut Icon" href="favicon.png" type="image/x-icon" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
<title>lib.scroll demo</title>
<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
}

ul, ol {
    -webkit-margin-before: 0;
    -webkit-margin-after: 0;
    -webkit-margin-start: 0;
    -webkit-margin-end: 0;
    -webkit-padding-before: 0;
    -webkit-padding-after: 0;
    -webkit-padding-start: 0;
    -webkit-padding-end: 0;
}

body * {
    -webkit-text-size-adjust:none;
    /*-webkit-user-select: none;*/
    -webkit-tap-highlight-color: rgba(0,0,0,0);
}

body > div {
    width:100%;
    height:100%;
    overflow:hidden;
    position:absolute;
    top:0;
    left:0;
}

.h-scroll {
    overflow:hidden; 
    height:50px; 
    width:100%;
    position:relative;
    z-index: 2;
}

.h-scroll section {
    display:-webkit-box;
    height:100%;
}

.h-scroll div {
    width:40px;
    text-align:center;
    line-height:50px;
    padding:0 10px;
}

.v-scroll {
    position:relative;
    z-index: 1;
    width:100%;
    height:100%;
    box-sizing:border-box;
    background-color:#000; 
    padding-top: 50px; 
    margin-top:-50px; 
    overflow:hidden; 
    display: -webkit-box;
}

.v-scroll > div {
    border:1px solid #ccc; 
    box-sizing: border-box; 
    width:50%; height:100%; 
    -webkit-flex:1; 
    overflow:hidden;
}

.v-scroll > div:first-child span, #outter span {
    height:25px;
}

#inner {
    border:1px solid red;
    margin:10px auto; 
    width:60%; 
    height:250px; 
    overflow:hidden;
}

#inner div {
    height:25px;
}

#boundaryTop, #boundaryBottom {
    height:50px;
    text-align:center;
    line-height:50px;
}

</style>
</head>
<body>
<div>
    <div class="h-scroll"><section></section></div>
    <div class="v-scroll">
        <div><section></section></div>
        <div>
            <section>
                <div id="boundaryTop">下拉刷新</div>
                <div id="outter"></div>
                <div id="inner"><section></section></div>
                <div id="boundaryBottom">上拉加载更多</div>
            </section>
        </div>
    </div>
</div>
<section style="height:1000px"></section>
<script src="build/combo.debug.js" type="text/javascript"></script>
<!--
<script src="../motion/build/motion.debug.js" type="text/javascript"></script>
<script src="../gesture/build/gesture.debug.js" type="text/javascript"></script>
-->
<script src="build/scroll.debug.js" type="text/javascript"></script>
<script type="text/javascript">
    (function () {
        var hScroll = document.querySelector('.h-scroll');
        var vScroll1 = document.querySelector('.v-scroll > div:first-child');
        var vScroll2 = document.querySelector('.v-scroll > div:last-child');
        var html1 = [], html2 = [], html3 = [];
        vScroll1.style.color = 'black';
        vScroll2.style.color = 'white';

        var html = '';
        for (var i = 0; i < 100; i++) {
            html += '<div><span>' + i + '</span></div>';
        }
        hScroll.querySelector('section').innerHTML = html;

        html = '';
        for (var i = 0; i < 50; i++) {
            html += '<span>' + i + '</span><br />';
        }
        vScroll1.querySelector('section').innerHTML = html;
        vScroll2.querySelector('#outter').innerHTML = html;

        html = '';
        for (var i = 0; i < 20; i++) {
            html += '<div><input type="text" value="' + i + '" /></div>';
        }
        vScroll2.querySelector('#inner section').innerHTML = html;

        var hScroller = hScroll.querySelector('section');
        var vScroller = vScroll1.querySelector('section');
        var vScrollOutter = vScroll2.querySelector('section');
        var vScrollInner = vScrollOutter.querySelector('section');
        hScroller.style.backgroundColor = '#FFF';
        vScroller.style.backgroundColor = '#CCC';
        vScrollOutter.style.backgroundColor = '#999';
        vScrollInner.style.backgroundColor = '#333';

        window['hScroller'] = lib.scroll(hScroller, {
            noBounce: true,
            isPrevent: true,
            direction: 'x'
        }).init();
        window['vScroller'] = lib.scroll(vScroller, {
            isPrevent: true
        }).init();
        window['vScrollOutter'] = lib.scroll(vScrollOutter, {
            bounceOffset:{
                top: 50, 
                bottom: 50
            }
        }).init();
        window['vScrollInner'] = lib.scroll(vScrollInner, {
            padding: {
                top: 20,
                bottom: 50
            }
        }).init();

        hScroller.addEventListener('pullright', function(e) {
            console.log('pullright', e.boundaryOffset);
        });

        hScroller.addEventListener('pullleft', function(e) {
            console.log('pullleft', e.boundaryOffset);
        });

        hScroller.addEventListener('scrollstart', function() {
            console.log('scrollstart');
        }, false);

        hScroller.addEventListener('scrollend', function() {
            console.log('scrollend');
        }, false);

        window.hScroller.addScrollingHandler(function(){
            console.log('scrolling');
        });

        vScrollOutter.addEventListener('pullup', function(e) {
            console.log('pullup', e.boundaryOffset);
            var boundaryBottom = vScrollOutter.querySelector('#boundaryBottom');
            if (e.boundaryOffset > 25 && boundaryBottom.innerHTML === '上拉加载更多') {
                boundaryBottom.innerHTML = '松开即加载';
            } else if (e.boundaryOffset <=25 && boundaryBottom.innerHTML === '松开即加载'){
                boundaryBottom.innerHTML = '上拉加载更多'
            }
        }, false);

        window.vScrollOutter.addPullupHandler(function(e, done) {
            console.log('pullupend');
            setTimeout(function() {
                window.vScrollOutter.scrollTo(window.vScrollOutter.getScrollHeight(), true);
                done();
            }, 2000);
        });

        vScrollOutter.addEventListener('pulldown', function(e) {
            console.log('pulldown', e.boundaryOffset);
            var boundaryTop = vScrollOutter.querySelector('#boundaryTop');
            if (e.boundaryOffset > 25 && boundaryTop.innerHTML === '下拉刷新') {
                boundaryTop.innerHTML = '松开即刷新';
            } else if (e.boundaryOffset <= 25 && boundaryTop.innerHTML === '松开即刷新'){
                boundaryTop.innerHTML = '下拉刷新'
            }
        }, false);

        window.vScrollOutter.addPulldownHandler(function(e, done) {
            console.log('pulldownend');
            setTimeout(function() {
                window.vScrollOutter.scrollTo(0, true);
                done();
            }, 2000);
        });
    })();
</script>

</body>
</html>

