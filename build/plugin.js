!function(a,b){var c=a.document,d=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(a){setTimeout(a,16)}}();b.scroll.plugin("addFixedElement",function(){this.options;getComputedStyle(this.viewport).position.match(/^relative|absolute$/)||(this.viewport.style.position="relative");var a=c.createDocumentFragment();if("y"===this.axis){var b=this.topFixedElement=c.createElement("div");b.className="top-fixed",b.style.cssText="position: absolute; top: 0; left: 0; width: 100%;";var d=this.bottomFixedElement=c.createElement("div");d.className="bottom-fxied",d.style.cssText="position: absolute; bottom: 0; left: 0; width: 100%",a.appendChild(b),a.appendChild(d)}else{var e=this.leftFixedElement=c.createElement("div");e.className="left-fixed",e.style.cssText="position: absolute; top: 0; left: 0; height: 100%;";var f=this.rightFixedElement=c.createElement("div");f.className="right-fxied",f.style.cssText="position: absolute; top: 0; right: 0; height: 100%;",a.appendChild(e),a.appendChild(f)}this.viewport.appendChild(a)}),b.scroll.plugin("lazyload",function(a,b){{var c=this;this.options}this.checkLazyload=function(){var a=Array.prototype.slice.call(this.element.querySelectorAll(".lazy"));a.filter(function(a){return c.isInView(a)}).forEach(function(a){if(b.onLazyLoad)b.onLazyLoad(a);else{var c=a;if("IMG"!==c.tagName.toUpperCase()&&(c=a.querySelector("img[data-src]")),c){var d=c.getAttribute("data-src");d&&(c.src=d,c.removeAttribute("data-src"))}a.className=a.className.split(" ").map(function(a){return"lazy"!==a}).join(" ")}})},b.realTimeLoad?this.addScrollingHandler(function(){c.checkLazyload()}):this.addScrollendHandler(function(){c.checkLazyload()}),this.element.addEventListener("refresh",function(){c.checkLazyload()}),d(function(){c.checkLazyload()})}),b.scroll.plugin("sticky",function(){this.options;this.enablePlugin("addFixedElement"),this.makeSticky=function(a){var b=this;if(a){if(a.className.indexOf("sticky-able")>=0)return;a.style.position="absolute",a.className=a.className.split(/\s+/).filter(function(a){return"sticky"!=a}).join(" ")+" sticky-able";var c=a.parentNode;this.addScrollingHandler(function(){b.checkSticky(a,c)}),this.addScrollendHandler(function(){b.checkSticky(a,c)})}else Array.prototype.slice.call(this.element.querySelectorAll(".sticky")).forEach(function(a){b.makeSticky(a)})},this.checkSticky=function(a,b){this.getRect(b).top<0?this.topFixedElement.appendChild(a):this.getRect(b).top>0&&b.appendChild(a)},this.makeSticky()}),b.scroll.plugin("update",function(a,b){function e(){if(!l){var a=h.getBoundingClientRect().height;l=!0,f.disable(),i&&(h.querySelector("span").innerHTML=k),d(function(){h.style.webkitTransition="-webkit-transform 0.4s ease 0",h.style.webkitTransform="translateY(0)",f.element.style.webkitTransition="-webkit-transform 0.4s ease 0",f.element.style.webkitTransform="translateY("+(f.maxScrollOffset-a)+"px)"}),setTimeout(function(){if(!b.onupdate)throw new Error('no "onupdate" Handler');b.onupdate.call(f,h,function(){d(function(){h.style.webkitTransition="",h.style.webkitTransform="translateY("+a+"px)",i&&(h.querySelector("span").innerHTML=j),f.enable(),f.refresh(),l=!1})})},400)}}var f=this,g=(this.options,b.offset),h=c.createElement("div");h.className="update",h.style.cssText="position: absolute; bottom: "+(g||0)+"px; left: 0; width: 100%;",b.height=b.height||.05*this.viewport.getBoundingClientRect().height,h.style.webkitTransform="translateY("+b.height+"px)",h.style.height=b.height;var i=!1;if("string"==typeof b.element)h.innerHTML=b.element;else if(b.element instanceof HTMLElement)h.appendChild(b.element);else{var j="上拉即可加载",k="加载中...";i=!0,h.style.backgroundColor="#FFF",h.innerHTML='<div style="height:'+b.height+";line-height:"+b.height+';text-align:center;"><span>'+j+"</span></div>"}this.viewport.appendChild(h);var l;this.addScrollingHandler(function(a){if(a.afterFlick&&!l){var c=f.getScrollTop();if(!(0>c)){var d=f.getBoundaryOffset(),g=h.getBoundingClientRect().height;h.style.webkitTransform="translateY("+(g-d)+"px)",d>.5*g?e():b.onpull&&b.onpull.call(f,h)}}}),this.element.addEventListener("pullup",function(){if(!l){var a=f.getBoundaryOffset(),c=h.getBoundingClientRect().height;h.style.webkitTransform="translateY("+(c-a)+"px)",b.onpull&&b.onpull.call(f,h)}},!1),this.element.addEventListener("pullupend",function(){if(!l){var a=f.getBoundaryOffset(),b=h.getBoundingClientRect().height;a>b?e():(h.style.webkitTransition="-webkit-transform 0.4s ease 0",h.style.webkitTransform="translateY("+b+"px)",setTimeout(function(){h.style.webkitTransition="",h.style.webkitTransform="translateY("+b+"px)",i&&(h.querySelector("span").innerHTML=j)},400))}},!1)}),b.scroll.plugin("refresh",function(a,b){function e(){if(!l){l=!0,f.disable();var a=h.getBoundingClientRect().height;i&&(h.querySelector("span").innerHTML=k),d(function(){h.style.webkitTransition="-webkit-transform 0.4s ease 0",h.style.webkitTransform="translateY(0)",f.element.style.webkitTransition="-webkit-transform 0.4s ease 0",f.element.style.webkitTransform="translateY("+-(f.minScrollOffset-a)+"px)"}),setTimeout(function(){b.onrefresh.call(f,h,function(){d(function(){h.style.webkitTransition="-webkit-transform 0.4s ease 0",h.style.webkitTransform="translateY(-"+a+"px)",f.scrollTo(0,!0),setTimeout(function(){h.style.webkitTransition="",h.style.webkitTransform="translateY(-"+a+"px)",i&&(h.querySelector("span").innerHTML=j),f.enable(),f.refresh(),l=!1},400)})})},400)}}var f=this,g=(this.options,b.offset);null==g&&(g=this.element.getBoundingClientRect().top-this.viewport.getBoundingClientRect().top);var h=c.createElement("div");h.className="refresh",h.style.cssText="position: absolute; top: "+(g||0)+"px; left: 0; width: 100%;",b.height=b.height||.05*this.viewport.getBoundingClientRect().height,h.style.webkitTransform="translateY(-"+b.height+"px)",h.style.height=b.height;var i=!1;if("string"==typeof b.element)h.innerHTML=b.element;else if(b.element instanceof HTMLElement)h.appendChild(b.element);else{var j="下拉即可刷新",k="刷新中...";i=!0,h.style.backgroundColor="#FFF",h.innerHTML='<div style="height:'+b.height+";line-height:"+b.height+';text-align:center;"><span>'+j+"</span></div>"}this.viewport.appendChild(h);var l;this.element.addEventListener("pulldown",function(){if(!l){var a=f.getBoundaryOffset(),c=h.getBoundingClientRect().height;h.style.webkitTransform="translateY("+-(c-a)+"px)",b.onpull&&b.onpull.call(f,h)}},!1),this.element.addEventListener("pulldownend",function(){if(!l){var a=f.getBoundaryOffset(),b=h.getBoundingClientRect().height;a>b?e():(h.style.webkitTransition="-webkit-transform 0.4s ease 0",h.style.webkitTransform="translateY(-"+b+"px)",setTimeout(function(){h.style.webkitTransition="",h.style.webkitTransform="translateY(-"+b+"px)",i&&(h.querySelector("span").innerHTML=j)},400))}},!1)})}(window,window.lib||(window.lib={}));