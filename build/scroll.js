!function(a,b){function c(){b.scroll.outputDebugLog&&console.debug.apply(console,arguments)}function d(a){var b=a.getBoundingClientRect();if(!b){b={},b.width=a.offsetWidth,b.height=a.offsetHeight,b.left=a.offsetLeft,b.top=a.offsetTop;for(var c=a.offsetParent;c;)b.left+=c.offsetLeft,b.top+=c.offsetTop,c=c.offsetParent;b.right=b.left+b.width,b.bottom=b.top+b.height}return b}function e(a){return 0-a.options[a.axis+"Padding1"]}function f(a){var b=d(a.element),c=d(a.viewport),f=e(a);if("y"===a.axis)var g=0-b.height+c.height;else var g=0-b.width+c.width;return Math.min(g+a.options[a.axis+"Padding2"],f)}function g(a,b){return b>a.minScrollOffset?b-a.minScrollOffset:b<a.maxScrollOffset?b-a.maxScrollOffset:void 0}function h(a,b){return b>a.minScrollOffset?b=a.minScrollOffset:b<a.maxScrollOffset&&(b=a.maxScrollOffset),b}function i(a,b,d){c(a.element.scrollId,b,d);var e=m.createEvent("HTMLEvents");if(e.initEvent(b,!1,!0),e.scrollObj=a,d)for(var f in d)e[f]=d[f];a.element.dispatchEvent(e),a.viewport.dispatchEvent(e)}function j(a){var b,c={x:0,y:0},d=getComputedStyle(a.element)[v+"Transform"];return"none"!==d&&(b=d.match(/^matrix3d\((?:[-\d.]+,\s*){12}([-\d.]+),\s*([-\d.]+)(?:,\s*[-\d.]+){2}\)/)||d.match(/^matrix\((?:[-\d.]+,\s*){4}([-\d.]+),\s*([-\d.]+)\)$/))&&(c.x=parseFloat(b[1])||0,c.y=parseFloat(b[2])||0),c}function k(a,b){return a=parseFloat(a),b=parseFloat(b),0!=a&&(a+="px"),0!=b&&(b+="px"),w?"translate3d("+a+", "+b+", 0)":"translate("+a+", "+b+")"}function l(a,l){function m(a){return F||L?(a.preventDefault(),a.stopPropagation(),!1):!0}function n(a){F||L||setTimeout(function(){var b=document.createEvent("HTMLEvents");b.initEvent("niceclick",!0,!0),a.target.dispatchEvent(b)},300)}function q(a,c){I=null,clearTimeout(J),J=setTimeout(function(){I&&(I=null,b.animation.requestFrame(a))},c||400),I=a}function t(a){if(!E.enabled)return!1;if("undefined"!=typeof a.isVertical){if(!("y"===E.axis&&a.isVertical||"x"===E.axis&&!a.isVertical))return!1;a.stopPropagation()}return!0}function w(b){if(t(b))if(L&&D(),l.useFrameAnimation)H&&H.stop(),H=null;else{var c=getComputedStyle(a)[v+"Transform"];a.style[v+"Transform"]=c,a.style[v+"Transition"]="",I=null,clearTimeout(J)}}function y(c){if(t(c)){var d=j(E)[E.axis],e=g(E,d);if(e){var f=h(E,d);if(e>0?i(E,"y"===E.axis?"pulldownend":"pullrightend"):0>e&&i(E,"y"===E.axis?"pullupend":"pullleftend"),l.useFrameAnimation){var m=f-d;H=new b.animation(400,b.cubicbezier.ease,0,function(b,c){var e=(d+m*c).toFixed(2);a.style[v+"Transform"]="y"===E.axis?k(0,e):k(e,0),i(E,"scrolling")}),H.onend(D),H.play()}else{a.style[v+"Transition"]=u+"transform 0.4s ease 0s";var n=f.toFixed(0);setTimeout(function(){a.style[v+"Transform"]="y"===E.axis?k(0,n):k(n,0)},0),q(D,400),b.animation.requestFrame(function(){L&&E.enabled&&(i(E,"scrolling"),b.animation.requestFrame(arguments.callee))})}}else L&&D()}}function z(a){t(a)&&(E.transformOffset=j(E),E.minScrollOffset=e(E),E.maxScrollOffset=f(E),K=2.5,N=!0,L=!0,M=!1,i(E,"scrollstart"),O=a["displacement"+E.axis.toUpperCase()])}function A(b){if(t(b)){var c=b["displacement"+E.axis.toUpperCase()];if(Math.abs(c-O)<5)return b.stopPropagation(),void 0;O=c;var d=E.transformOffset[E.axis]+c;d>E.minScrollOffset?(d=E.minScrollOffset+(d-E.minScrollOffset)/K,K*=1.003):d<E.maxScrollOffset&&(d=E.maxScrollOffset-(E.maxScrollOffset-d)/K,K*=1.003),K>4&&(K=4);var e=g(E,d);e&&(i(E,e>0?"y"===E.axis?"pulldown":"pullright":"y"===E.axis?"pullup":"pullleft",{boundaryOffset:Math.abs(e)}),E.options.noBounce&&(d=h(E,d))),a.style[v+"Transform"]="y"===E.axis?k(0,d.toFixed(2)):k(d.toFixed(2),0),i(E,"scrolling")}}function B(a){t(a)&&a.isflick&&C(a)}function C(d){N=!0;var e,f,h,m,n,o,p,s,t,w,x,y,z,A,B,C,F;m=j(E)[E.axis];var G=g(E,m);if(!G){e=d["velocity"+E.axis.toUpperCase()];var I=2,J=.0015;l.inertia&&r[l.inertia]&&(I=r[l.inertia][0],J=r[l.inertia][1]),e>I&&(e=I),-I>e&&(e=-I),f=J*(e/Math.abs(e)),o=new b.motion({v:e,a:-f}),h=o.t,n=m+o.s;var K=g(E,n);if(K){c("惯性计算超出了边缘",K),p=e,s=f,K>0?(w=E.minScrollOffset,y=1):(w=E.maxScrollOffset,y=-1),x=new b.motion({v:y*p,a:-y*s,s:Math.abs(w-m)}),t=x.t;var O=x.generateCubicBezier();z=p-s*t,A=.03*(z/Math.abs(z)),F=new b.motion({v:z,a:-A}),B=F.t,C=w+F.s;{F.generateCubicBezier()}if(l.noBounce)if(c("没有回弹效果"),m!==w)if(l.useFrameAnimation){var P=w-m,Q=b.cubicbezier(O[0][0],O[0][1],O[1][0],O[1][1]);H=new b.animation(t.toFixed(0),Q,0,function(b,c){i(E,"scrolling",{afterFlick:!0});var d=m+P*c;a.style[v+"Transform"]="y"===E.axis?k(0,d.toFixed(2)):k(d.toFixed(2),0)}),H.onend(D),H.play()}else{a.style[v+"Transition"]=u+"transform "+(t/1e3).toFixed(2)+"s cubic-bezier("+O+") 0s";var R=w.toFixed(0);setTimeout(function(){a.style[v+"Transform"]="y"===E.axis?k(0,R):k(R,0)},0),q(D,1e3*(t/1e3).toFixed(2))}else D();else if(m!==C)if(c("惯性滚动","s="+C.toFixed(0),"t="+((t+B)/1e3).toFixed(2)),l.useFrameAnimation){var P=C-m,Q=b.cubicbezier.easeOut;H=new b.animation((t+B).toFixed(0),Q,0,function(b,c){i(E,"scrolling",{afterFlick:!0});var d=m+P*c;a.style[v+"Transform"]="y"===E.axis?k(0,d.toFixed(2)):k(d.toFixed(2),0)}),H.onend(function(){if(E.enabled){var c=w-C,d=b.cubicbezier.ease;H=new b.animation(400,d,0,function(b,d){i(E,"scrolling",{afterFlick:!0});var e=C+c*d;a.style[v+"Transform"]="y"===E.axis?k(0,e.toFixed(2)):k(e.toFixed(2),0)}),H.onend(D),H.play()}}),H.play()}else{a.style[v+"Transition"]=u+"transform "+((t+B)/1e3).toFixed(2)+"s ease-out 0s";var R=C.toFixed(0);setTimeout(function(){a.style[v+"Transform"]="y"===E.axis?k(0,R):k(R,0)},0),q(function(){if(E.enabled)if(c("惯性回弹","s="+w.toFixed(0),"t=400"),C!==w){a.style[v+"Transition"]=u+"transform 0.4s ease 0s";var b=w.toFixed(0);setTimeout(function(){a.style[v+"Transform"]="y"===E.axis?k(0,b):k(b,0)},0),q(D,400)}else D()},1e3*((t+B)/1e3).toFixed(2))}else D()}else{c("惯性计算没有超出边缘");var S=o.generateCubicBezier();if(l.useFrameAnimation){var P=n-m,Q=b.cubicbezier(S[0][0],S[0][1],S[1][0],S[1][1]);H=new b.animation(h.toFixed(0),Q,0,function(b,c){i(E,"scrolling",{afterFlick:!0});var d=(m+P*c).toFixed(2);a.style[v+"Transform"]="y"===E.axis?k(0,d):k(d,0)}),H.onend(D),H.play()}else{a.style[v+"Transition"]=u+"transform "+(h/1e3).toFixed(2)+"s cubic-bezier("+S+") 0s";var R=n.toFixed(0);setTimeout(function(){a.style[v+"Transform"]="y"===E.axis?k(0,R):k(R,0)},0),q(D,1e3*(h/1e3).toFixed(2))}}M=!0,l.useFrameAnimation||b.animation.requestFrame(function(){L&&M&&E.enabled&&(i(E,"scrolling",{afterFlick:!0}),b.animation.requestFrame(arguments.callee))})}}function D(){E.enabled&&(N=!1,setTimeout(function(){!N&&L&&(L=!1,M=!1,l.useFrameAnimation?(H&&H.stop(),H=null):a.style[v+"Transition"]="",i(E,"scrollend"))},50))}var E=this;if(l=l||{},l.noBounce=!!l.noBounce,l.padding=l.padding||{},l.isPrevent=null==l.isPrevent?!0:!!l.isPrevent,l.isFixScrollendClick=null==l.isFixScrollendClick?!0:!!l.isFixScrollendClick,l.padding?(l.yPadding1=-l.padding.top||0,l.yPadding2=-l.padding.bottom||0,l.xPadding1=-l.padding.left||0,l.xPadding2=-l.padding.right||0):(l.yPadding1=0,l.yPadding2=0,l.xPadding1=0,l.xPadding2=0),l.margin?(l.yMargin1=-l.margin.top||0,l.yMargin2=-l.margin.bottom||0,l.xMargin1=-l.margin.left||0,l.xMargin2=-l.margin.right||0):(l.yMargin1=0,l.yMargin2=0,l.xMargin1=0,l.xMargin2=0),l.direction=l.direction||"y",l.inertia=l.inertia||"normal",this.options=l,E.axis=l.direction,this.element=a,this.viewport=a.parentNode,this.plugins={},this.viewport.addEventListener("touchstart",w,!1),this.viewport.addEventListener("touchend",y,!1),this.viewport.addEventListener("touchcancel",y,!1),this.viewport.addEventListener("panstart",z,!1),this.viewport.addEventListener("pan",A,!1),this.viewport.addEventListener("panend",B,!1),this.element.scrollId=setTimeout(function(){o[E.element.scrollId+""]=E},1),l.isPrevent&&(this.viewport.addEventListener("touchstart",function(){x=!0},!1),E.viewport.addEventListener("touchend",function(){x=!1},!1)),l.isFixScrollendClick){var F,G;this.viewport.addEventListener("scrolling",function(){F=!0,G&&clearTimeout(G),G=setTimeout(function(){F=!1},400)},!1),this.viewport.addEventListener("click",m,!1),this.viewport.addEventListener("tap",n,!1)}if(l.useFrameAnimation){var H;Object.defineProperty(this,"animation",{get:function(){return H}})}else{var I,J=0;a.addEventListener(s?"transitionend":v+"TransitionEnd",function(a){if(I){var c=I;I=null,clearTimeout(J),b.animation.requestFrame(function(){c(a)})}},!1)}var K,L,M,N;Object.defineProperty(this,"isScrolling",{get:function(){return!!L}});var O,P={init:function(){return this.enable(),this.refresh(),this.scrollTo(0),this},enable:function(){return this.enabled=!0,this},disable:function(){var a=this.element;return this.enabled=!1,this.options.useFrameAnimation?H&&H.stop():b.animation.requestFrame(function(){a.style[v+"Transform"]=getComputedStyle(a)[v+"Transform"]}),this},getScrollWidth:function(){return d(this.element).width},getScrollHeight:function(){return d(this.element).height},getScrollLeft:function(){return-j(this).x-this.options.xPadding1},getScrollTop:function(){return-j(this).y-this.options.yPadding1},getMaxScrollLeft:function(){return-E.maxScrollOffset-this.options.xPadding1},getMaxScrollTop:function(){return-E.maxScrollOffset-this.options.yPadding1},getBoundaryOffset:function(){return Math.abs(g(this,j(this)[this.axis])||0)},refresh:function(){var a=this.element,b="y"===this.axis,c=b?"height":"width";if(null!=this.options[c])a.style[c]=this.options[c]+"px";else if(this.options.useElementRect)a.style[c]="auto",a.style[c]=d(a)[c]+"px";else if(a.childElementCount>0){var g,h,k=a.firstElementChild,l=a.lastElementChild;if(document.createRange&&!this.options.ignoreOverflow&&(g=document.createRange(),g.selectNodeContents(a),h=d(g)),h)a.style[c]=h[c]+"px";else{for(;k&&0===d(k)[c]&&k.nextElementSibling;)k=k.nextElementSibling;for(;l&&l!==k&&0===d(l)[c]&&l.previousElementSibling;)l=l.previousElementSibling;a.style[c]=d(l)[b?"bottom":"right"]-d(k)[b?"top":"left"]+"px"}}return this.transformOffset=j(this),this.minScrollOffset=e(this),this.maxScrollOffset=f(this),this.scrollTo(-this.transformOffset[this.axis]-this.options[this.axis+"Padding1"]),i(this,"contentrefresh"),this},offset:function(a){var b=d(this.element),c=d(a);if("y"===this.axis){var e={top:c.top-b.top-this.options.yPadding1,left:c.left-b.left,right:b.right-c.right,width:c.width,height:c.height};e.bottom=e.top+e.height}else{var e={top:c.top-b.top,bottom:b.bottom-c.bottom,left:c.left-b.left-this.options.xPadding1,width:c.width,height:c.height};e.right=e.left+e.width}return e},getRect:function(a){var b=d(this.viewport),c=d(a);if("y"===this.axis){var e={top:c.top-b.top,left:c.left-b.left,right:b.right-c.right,width:c.width,height:c.height};e.bottom=e.top+e.height}else{var e={top:c.top-b.top,bottom:b.bottom-c.bottom,left:c.left-b.left,width:c.width,height:c.height};e.right=e.left+e.width}return e},isInView:function(a){var b=d(this.viewport),c=this.getRect(a);return"y"===this.axis?b.top<c.bottom&&b.bottom>c.top:b.left<c.right&&b.right>c.left},scrollTo:function(a,c){var d=this,e=this.element;if(a=-a-this.options[this.axis+"Padding1"],a=h(this,a),L=!0,c===!0)if(this.options.useFrameAnimation){var f=j(d)[this.axis],g=a-f;H=new b.animation(400,b.cubicbezier.ease,0,function(a,b){var c=(f+g*b).toFixed(2);e.style[v+"Transform"]="y"===d.axis?k(0,c):k(c,0),i(d,"scrolling")}),H.onend(D),H.play()}else e.style[v+"Transition"]=u+"transform 0.4s ease 0s",setTimeout(function(){e.style[v+"Transform"]="y"===d.axis?k(j(d).x,a):k(a,j(d).y)},0),q(D,400),b.animation.requestFrame(function(){L&&d.enabled&&(i(d,"scrolling"),b.animation.requestFrame(arguments.callee))});else this.options.useFrameAnimation||(e.style[v+"Transition"]=""),setTimeout(function(){e.style[v+"Transform"]="y"===d.axis?k(j(d).x,a):k(a,j(d).y)},0),D();return this},scrollToElement:function(a,b){var c=this.offset(a);return c=c["y"===this.axis?"top":"left"],this.scrollTo(c,b)},getViewWidth:function(){return d(this.viewport).width},getViewHeight:function(){return d(this.viewport).height},addPulldownHandler:function(a){var b=this;return this.element.addEventListener("pulldownend",function(c){b.disable(),a.call(b,c,function(){b.scrollTo(0,!0),b.enable()})},!1),this},addPullupHandler:function(a){var b=this;return this.element.addEventListener("pullupend",function(c){b.disable(),a.call(b,c,function(){b.scrollTo(b.getScrollHeight(),!0),b.enable()})},!1),this},addScrollstartHandler:function(a){var b=this;return this.element.addEventListener("scrollstart",function(c){a.call(b,c)},!1),this},addScrollingHandler:function(a){var b=this;return this.element.addEventListener("scrolling",function(c){a.call(b,c)},!1),this},addScrollendHandler:function(a){var b=this;return this.element.addEventListener("scrollend",function(c){a.call(b,c)},!1),this},addEventListener:function(a,b,c){var d=this;this.element.addEventListener(a,function(a){b.call(d,a)},!!c)},removeEventListener:function(a,b){var c=this;this.element.removeEventListener(a,function(a){b.call(c,a)})},enablePlugin:function(a,b){var c=p[a];return c&&!this.plugins[a]&&(this.plugins[a]=!0,b=b||{},c.call(this,a,b)),this}};for(var Q in P)this[Q]=P[Q];delete P}var m=a.document,n=a.navigator.userAgent,o={},p={},q=a.dpr||(a.navigator.userAgent.match(/iPhone|iPad|iPod/)?document.documentElement.clientWidth/a.screen.availWidth:1),r={normal:[2*q,.0015*q],slow:[1.5*q,.003*q],veryslow:[1.5*q,.005*q]},s=!!n.match(/Firefox/i),t=!!n.match(/IEMobile/i),u=s?"-moz-":t?"-ms-":"-webkit-",v=s?"Moz":t?"ms":"webkit",w="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,x=!1;m.addEventListener("touchmove",function(a){return x?(a.preventDefault(),!1):!0},!1),b.scroll=function(a,b){if(1===arguments.length&&!(arguments[0]instanceof HTMLElement))if(b=arguments[0],b.scrollElement)a=b.scrollElement;else{if(!b.scrollWrap)throw new Error("no scroll element");a=b.scrollWrap.firstElementChild}if(!a.parentNode)throw new Error("wrong dom tree");if(b&&b.direction&&["x","y"].indexOf(b.direction)<0)throw new Error("wrong direction");var c;return c=a.scrollId?o[a.scrollId]:new l(a,b)},b.scroll.plugin=function(a,b){return b?(a=a.split(","),a.forEach(function(a){p[a]=b}),void 0):p[a]}}(window,window.lib||(window.lib={}));