!function(a,b){function c(){b.scroll.outputDebugLog&&console.debug.apply(console,arguments)}function d(a){var b=a.getBoundingClientRect();if(!b){b={},b.width=a.offsetWidth,b.height=a.offsetHeight,b.left=a.offsetLeft,b.top=a.offsetTop;for(var c=a.offsetParent;c;)b.left+=c.offsetLeft,b.top+=c.offsetTop,c=c.offsetParent;b.right=b.left+b.width,b.bottom=b.top+b.height}return b}function e(a){return 0-a.options[a.axis+"Padding1"]}function f(a){var b=d(a.element),c=d(a.viewport),f=e(a);if("y"===a.axis)var g=0-b.height+c.height;else var g=0-b.width+c.width;return Math.min(g+a.options[a.axis+"Padding2"],f)}function g(a,b){return b>a.minScrollOffset?b-a.minScrollOffset:b<a.maxScrollOffset?b-a.maxScrollOffset:void 0}function h(a,b){return b>a.minScrollOffset?b=a.minScrollOffset:b<a.maxScrollOffset&&(b=a.maxScrollOffset),b}function i(a,b,d){c(a.element.scrollId,b,d);var e=o.createEvent("HTMLEvents");if(e.initEvent(b,!1,!0),e.scrollObj=a,d)for(var f in d)e[f]=d[f];a.element.dispatchEvent(e),a.viewport.dispatchEvent(e)}function j(a){var b,c={x:0,y:0},d=getComputedStyle(a.element)[w+"Transform"];return"none"!==d&&(b=d.match(/^matrix3d\((?:[-\d.]+,\s*){12}([-\d.]+),\s*([-\d.]+)(?:,\s*[-\d.]+){2}\)/)||d.match(/^matrix\((?:[-\d.]+,\s*){4}([-\d.]+),\s*([-\d.]+)\)$/))&&(c.x=parseFloat(b[1])||0,c.y=parseFloat(b[2])||0),c}function k(a,b){return a=parseFloat(a),b=parseFloat(b),0!=a&&(a+="px"),0!=b&&(b+="px"),x?"translate3d("+a+", "+b+", 0)":"translate("+a+", "+b+")"}function l(a,b,c){a.element.style[w+"Transition"]=1===arguments.length?"":v+"transform "+b+" "+c+" 0s"}function m(a,b){a.element.style[w+"Transform"]="y"===a.axis?k(0,b):k(b,0)}function n(a,k){function n(a){return E||K?(a.preventDefault(),a.stopPropagation(),!1):!0}function o(a){E||K||setTimeout(function(){var b=document.createEvent("HTMLEvents");b.initEvent("niceclick",!0,!0),a.target.dispatchEvent(b)},300)}function p(a,c){H=null,clearTimeout(I),I=setTimeout(function(){H&&(H=null,b.animation.requestFrame(a))},c||400),H=a}function r(a){if(!D.enabled)return!1;if("undefined"!=typeof a.isVertical){if(!("y"===D.axis&&a.isVertical||"x"===D.axis&&!a.isVertical))return!1;a.stopPropagation()}return!0}function u(b){r(b)&&(K&&C(),k.useFrameAnimation?(G&&G.stop(),G=null):(a.style[w+"Transform"]=getComputedStyle(a)[w+"Transform"],l(D,"",""),H=null,clearTimeout(I)))}function v(a){if(r(a)){var c=j(D)[D.axis],d=g(D,c);if(d){var e=h(D,c);if(d>0?i(D,"y"===D.axis?"pulldownend":"pullrightend"):0>d&&i(D,"y"===D.axis?"pullupend":"pullleftend"),k.useFrameAnimation){var f=e-c;G=new b.animation(400,b.cubicbezier.ease,0,function(a,b){var d=(c+f*b).toFixed(2);m(D,d),i(D,"scrolling")}),G.onend(C),G.play()}else{var n=e.toFixed(0);l(D,"0.4s","ease"),m(D,n),p(C,400),b.animation.requestFrame(function(){K&&D.enabled&&(i(D,"scrolling"),b.animation.requestFrame(arguments.callee))})}}else K&&C()}}function x(a){r(a)&&(D.transformOffset=j(D),D.minScrollOffset=e(D),D.maxScrollOffset=f(D),J=2.5,M=!0,K=!0,L=!1,i(D,"scrollstart"),N=a["displacement"+D.axis.toUpperCase()])}function z(a){if(r(a)){var b=a["displacement"+D.axis.toUpperCase()];if(Math.abs(b-N)<5)return a.stopPropagation(),void 0;N=b;var c=D.transformOffset[D.axis]+b;c>D.minScrollOffset?(c=D.minScrollOffset+(c-D.minScrollOffset)/J,J*=1.003):c<D.maxScrollOffset&&(c=D.maxScrollOffset-(D.maxScrollOffset-c)/J,J*=1.003),J>4&&(J=4);var d=g(D,c);d&&(i(D,d>0?"y"===D.axis?"pulldown":"pullright":"y"===D.axis?"pullup":"pullleft",{boundaryOffset:Math.abs(d)}),D.options.noBounce&&(c=h(D,c))),m(D,c.toFixed(2)),i(D,"scrolling")}}function A(a){r(a)&&a.isflick&&B(a)}function B(a){M=!0;var d,e,f,h,n,o,q,r,t,u,v,w,x,y,z,A,B;h=j(D)[D.axis];var E=g(D,h);if(!E){d=a["velocity"+D.axis.toUpperCase()];var F=2,H=.0015;k.inertia&&s[k.inertia]&&(F=s[k.inertia][0],H=s[k.inertia][1]),d>F&&(d=F),-F>d&&(d=-F),e=H*(d/Math.abs(d)),o=new b.motion({v:d,a:-e}),f=o.t,n=h+o.s;var I=g(D,n);if(I){c("惯性计算超出了边缘",I),q=d,r=e,I>0?(u=D.minScrollOffset,w=1):(u=D.maxScrollOffset,w=-1),v=new b.motion({v:w*q,a:-w*r,s:Math.abs(u-h)}),t=v.t;var J=v.generateCubicBezier();x=q-r*t,y=.03*(x/Math.abs(x)),B=new b.motion({v:x,a:-y}),z=B.t,A=u+B.s;{B.generateCubicBezier()}if(k.noBounce)if(c("没有回弹效果"),h!==u)if(k.useFrameAnimation){var N=u-h,O=b.cubicbezier(J[0][0],J[0][1],J[1][0],J[1][1]);G=new b.animation(t.toFixed(0),O,0,function(a,b){var c=h+N*b;j(D,c.toFixed(2)),i(D,"scrolling",{afterFlick:!0})}),G.onend(C),G.play()}else{var P=u.toFixed(0);l(D,(t/1e3).toFixed(2)+"s","cubic-bezier("+J+")"),m(D,P),p(C,1e3*(t/1e3).toFixed(2))}else C();else if(h!==A)if(c("惯性滚动","s="+A.toFixed(0),"t="+((t+z)/1e3).toFixed(2)),k.useFrameAnimation){var N=A-h,O=b.cubicbezier.easeOut;G=new b.animation((t+z).toFixed(0),O,0,function(a,b){var c=h+N*b;m(D,c.toFixed(2)),i(D,"scrolling",{afterFlick:!0})}),G.onend(function(){if(D.enabled){var a=u-A,c=b.cubicbezier.ease;G=new b.animation(400,c,0,function(b,c){var d=A+a*c;m(D,d.toFixed(2)),i(D,"scrolling",{afterFlick:!0})}),G.onend(C),G.play()}}),G.play()}else{var P=A.toFixed(0);l(D,((t+z)/1e3).toFixed(2)+"s","ease-out"),m(D,P),p(function(){if(D.enabled)if(c("惯性回弹","s="+u.toFixed(0),"t=400"),A!==u){var a=u.toFixed(0);l(D,"0.4s","ease"),m(D,a),p(C,400)}else C()},1e3*((t+z)/1e3).toFixed(2))}else C()}else{c("惯性计算没有超出边缘");var Q=o.generateCubicBezier();if(k.useFrameAnimation){var N=n-h,O=b.cubicbezier(Q[0][0],Q[0][1],Q[1][0],Q[1][1]);G=new b.animation(f.toFixed(0),O,0,function(a,b){var c=(h+N*b).toFixed(2);m(D,c),i(D,"scrolling",{afterFlick:!0})}),G.onend(C),G.play()}else{var P=n.toFixed(0);l(D,(f/1e3).toFixed(2)+"s","cubic-bezier("+Q+")"),m(D,P),p(C,1e3*(f/1e3).toFixed(2))}}L=!0,k.useFrameAnimation||b.animation.requestFrame(function(){K&&L&&D.enabled&&(i(D,"scrolling",{afterFlick:!0}),b.animation.requestFrame(arguments.callee))})}}function C(){D.enabled&&(M=!1,setTimeout(function(){!M&&K&&(K=!1,L=!1,k.useFrameAnimation?(G&&G.stop(),G=null):l(D,"",""),i(D,"scrollend"))},50))}var D=this;if(k=k||{},k.noBounce=!!k.noBounce,k.padding=k.padding||{},k.isPrevent=null==k.isPrevent?!0:!!k.isPrevent,k.isFixScrollendClick=null==k.isFixScrollendClick?!0:!!k.isFixScrollendClick,k.padding?(k.yPadding1=-k.padding.top||0,k.yPadding2=-k.padding.bottom||0,k.xPadding1=-k.padding.left||0,k.xPadding2=-k.padding.right||0):(k.yPadding1=0,k.yPadding2=0,k.xPadding1=0,k.xPadding2=0),k.margin?(k.yMargin1=-k.margin.top||0,k.yMargin2=-k.margin.bottom||0,k.xMargin1=-k.margin.left||0,k.xMargin2=-k.margin.right||0):(k.yMargin1=0,k.yMargin2=0,k.xMargin1=0,k.xMargin2=0),k.direction=k.direction||"y",k.inertia=k.inertia||"normal",this.options=k,D.axis=k.direction,this.element=a,this.viewport=a.parentNode,this.viewport.addEventListener("touchstart",u,!1),this.viewport.addEventListener("touchend",v,!1),this.viewport.addEventListener("touchcancel",v,!1),this.viewport.addEventListener("panstart",x,!1),this.viewport.addEventListener("pan",z,!1),this.viewport.addEventListener("panend",A,!1),this.element.scrollId=setTimeout(function(){q[D.element.scrollId+""]=D},1),k.isPrevent&&(this.viewport.addEventListener("touchstart",function(){y=!0},!1),D.viewport.addEventListener("touchend",function(){y=!1},!1)),k.isFixScrollendClick){var E,F;this.viewport.addEventListener("scrolling",function(){E=!0,F&&clearTimeout(F),F=setTimeout(function(){E=!1},400)},!1),this.viewport.addEventListener("click",n,!1),this.viewport.addEventListener("tap",o,!1)}if(k.useFrameAnimation){var G;Object.defineProperty(this,"animation",{get:function(){return G}})}else{var H,I=0;a.addEventListener(t?"transitionend":w+"TransitionEnd",function(a){if(H){var c=H;H=null,clearTimeout(I),b.animation.requestFrame(function(){c(a)})}},!1)}var J,K,L,M;Object.defineProperty(this,"isScrolling",{get:function(){return!!K}});var N,O={init:function(){return this.enable(),this.refresh(),this.scrollTo(0),this},enable:function(){return this.enabled=!0,this},disable:function(){var a=this.element;return this.enabled=!1,this.options.useFrameAnimation?G&&G.stop():b.animation.requestFrame(function(){a.style[w+"Transform"]=getComputedStyle(a)[w+"Transform"]}),this},getScrollWidth:function(){return d(this.element).width},getScrollHeight:function(){return d(this.element).height},getScrollLeft:function(){return-j(this).x-this.options.xPadding1},getScrollTop:function(){return-j(this).y-this.options.yPadding1},getMaxScrollLeft:function(){return-D.maxScrollOffset-this.options.xPadding1},getMaxScrollTop:function(){return-D.maxScrollOffset-this.options.yPadding1},getBoundaryOffset:function(){return Math.abs(g(this,j(this)[this.axis])||0)},refresh:function(){var a=this.element,b="y"===this.axis,c=b?"height":"width";if(null!=this.options[c])a.style[c]=this.options[c]+"px";else if(this.options.useElementRect)a.style[c]="auto",a.style[c]=d(a)[c]+"px";else if(a.childElementCount>0){var g,h,k=a.firstElementChild,l=a.lastElementChild;if(document.createRange&&!this.options.ignoreOverflow&&(g=document.createRange(),g.selectNodeContents(a),h=d(g)),h)a.style[c]=h[c]+"px";else{for(;k&&0===d(k)[c]&&k.nextElementSibling;)k=k.nextElementSibling;for(;l&&l!==k&&0===d(l)[c]&&l.previousElementSibling;)l=l.previousElementSibling;a.style[c]=d(l)[b?"bottom":"right"]-d(k)[b?"top":"left"]+"px"}}return this.transformOffset=j(this),this.minScrollOffset=e(this),this.maxScrollOffset=f(this),this.scrollTo(-this.transformOffset[this.axis]-this.options[this.axis+"Padding1"]),i(this,"contentrefresh"),this},offset:function(a){var b=d(this.element),c=d(a);if("y"===this.axis){var e={top:c.top-b.top-this.options.yPadding1,left:c.left-b.left,right:b.right-c.right,width:c.width,height:c.height};e.bottom=e.top+e.height}else{var e={top:c.top-b.top,bottom:b.bottom-c.bottom,left:c.left-b.left-this.options.xPadding1,width:c.width,height:c.height};e.right=e.left+e.width}return e},getRect:function(a){var b=d(this.viewport),c=d(a);if("y"===this.axis){var e={top:c.top-b.top,left:c.left-b.left,right:b.right-c.right,width:c.width,height:c.height};e.bottom=e.top+e.height}else{var e={top:c.top-b.top,bottom:b.bottom-c.bottom,left:c.left-b.left,width:c.width,height:c.height};e.right=e.left+e.width}return e},isInView:function(a){var b=this.getRect(this.viewport),c=this.getRect(a);return"y"===this.axis?b.top<c.bottom&&b.bottom>c.top:b.left<c.right&&b.right>c.left},scrollTo:function(a,c){{var d=this;this.element}if(a=-a-this.options[this.axis+"Padding1"],a=h(this,a),K=!0,c===!0)if(this.options.useFrameAnimation){var e=j(d)[this.axis],f=a-e;G=new b.animation(400,b.cubicbezier.ease,0,function(a,b){var c=(e+f*b).toFixed(2);m(d,c),i(d,"scrolling")}),G.onend(C),G.play()}else l(d,"0.4s","ease"),m(d,a),p(C,400),b.animation.requestFrame(function(){K&&d.enabled&&(i(d,"scrolling"),b.animation.requestFrame(arguments.callee))});else this.options.useFrameAnimation||l(d,"",""),m(d,a),C();return this},scrollToElement:function(a,b){var c=this.offset(a);return c=c["y"===this.axis?"top":"left"],this.scrollTo(c,b)},getViewWidth:function(){return d(this.viewport).width},getViewHeight:function(){return d(this.viewport).height},addPulldownHandler:function(a){var b=this;return this.element.addEventListener("pulldownend",function(c){b.disable(),a.call(b,c,function(){b.scrollTo(0,!0),b.enable()})},!1),this},addPullupHandler:function(a){var b=this;return this.element.addEventListener("pullupend",function(c){b.disable(),a.call(b,c,function(){b.scrollTo(b.getScrollHeight(),!0),b.enable()})},!1),this},addScrollstartHandler:function(a){var b=this;return this.element.addEventListener("scrollstart",function(c){a.call(b,c)},!1),this},addScrollingHandler:function(a){var b=this;return this.element.addEventListener("scrolling",function(c){a.call(b,c)},!1),this},addScrollendHandler:function(a){var b=this;return this.element.addEventListener("scrollend",function(c){a.call(b,c)},!1),this},addContentrenfreshHandler:function(a){var b=this;this.element.addEventListener("contentrefresh",function(c){a.call(b,c)},!1)},addEventListener:function(a,b,c){var d=this;this.element.addEventListener(a,function(a){b.call(d,a)},!!c)},removeEventListener:function(a,b){var c=this;this.element.removeEventListener(a,function(a){b.call(c,a)})}};for(var P in O)this[P]=O[P];delete O}var o=a.document,p=a.navigator.userAgent,q={},r=a.dpr||(a.navigator.userAgent.match(/iPhone|iPad|iPod/)?document.documentElement.clientWidth/a.screen.availWidth:1),s={normal:[2*r,.0015*r],slow:[1.5*r,.003*r],veryslow:[1.5*r,.005*r]},t=!!p.match(/Firefox/i),u=!!p.match(/IEMobile/i),v=t?"-moz-":u?"-ms-":"-webkit-",w=t?"Moz":u?"ms":"webkit",x="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,y=!1;o.addEventListener("touchmove",function(a){return y?(a.preventDefault(),!1):!0},!1),b.scroll=function(a,b){if(1===arguments.length&&!(arguments[0]instanceof HTMLElement))if(b=arguments[0],b.scrollElement)a=b.scrollElement;else{if(!b.scrollWrap)throw new Error("no scroll element");a=b.scrollWrap.firstElementChild}if(!a.parentNode)throw new Error("wrong dom tree");if(b&&b.direction&&["x","y"].indexOf(b.direction)<0)throw new Error("wrong direction");var c;return c=a.scrollId?q[a.scrollId]:new n(a,b)}}(window,window.lib||(window.lib={}));